<form
  [formGroup]="form"
  (ngSubmit)="onSubmit()"
  class="grid grid-cols-1 md:grid-cols-2 gap-6"
>
  @for (field of fields; track field.name) {

  <!-- Input Texto / Email / Number -->
  @if (field.type === 'text' || field.type === 'email' || field.type ===
  'number' || field.type === 'password') {
  <div>
    <label class="block mb-1 text-sm font-medium">{{ field.label }}</label>
    <input
      [type]="field.type"
      [formControlName]="field.name"
      [placeholder]="field.placeholder"
      class="input w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
    />

    <!-- Validação -->
    @if (form.get(field.name)?.hasError('required') &&
    (form.get(field.name)?.touched || form.get(field.name)?.dirty)) {
    <p class="text-red-600 text-xs mt-1">⚠️ {{ field.label }} é obrigatório</p>
    }
  </div>
  }

  <!-- Input Data -->
  @if (field.type === 'date') {
  <div>
    <label class="block mb-1 text-sm font-medium">{{ field.label }}</label>
    <input
      type="date"
      [formControlName]="field.name"
      class="input w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
    />

    <!-- Validação -->
    @if (form.get(field.name)?.hasError('required') &&
    (form.get(field.name)?.touched || form.get(field.name)?.dirty)) {
    <p class="text-red-600 text-xs mt-1">⚠️ {{ field.label }} é obrigatório</p>
    }
  </div>
  }

  <!-- Input Data/Hora -->
  @if (field.type === 'datetime-local') {
  <div>
    <label class="block mb-1 text-sm font-medium">{{ field.label }}</label>
    <input
      type="datetime-local"
      [formControlName]="field.name"
      class="input w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
    />

    <!-- Validação -->
    @if (form.get(field.name)?.hasError('required') &&
    (form.get(field.name)?.touched || form.get(field.name)?.dirty)) {
    <p class="text-red-600 text-xs mt-1">⚠️ {{ field.label }} é obrigatório</p>
    }
  </div>
  }

  <!-- Select / Icon Selector -->
  @if (field.type === 'select') {
  <div>
    <label class="block mb-1 text-sm font-medium">{{ field.label }}</label>

    <!-- Exibe <select> para selects normais -->
    @if (field.name !== 'iconMapUrl') {
    <select
      [formControlName]="field.name"
      class="input w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
    >
      <option value="">-- Selecione --</option>
      @for (opt of field.options; track opt) {
      <option [value]="opt">{{ opt }}</option>
      }
    </select>
    }

    <!-- Exibe ícones se for 'iconMapUrl' -->
    @if (field.name === 'iconMapUrl' && field.options) {
    <div class="mt-2 flex flex-wrap gap-4">
      @for (opt of field.options; track opt) {
      <div
        class="w-12 h-12 border-2 rounded-lg cursor-pointer hover:border-blue-500 transition"
        [class.border-blue-500]="form.get(field.name)?.value === opt"
        (click)="selectOption(field.name, opt)"
      >
        <img [src]="opt" class="w-full h-full object-contain" [alt]="opt" />
      </div>
      }
    </div>
    }

    <!-- Validação -->
    @if (form.get(field.name)?.hasError('required') &&
    (form.get(field.name)?.touched || form.get(field.name)?.dirty)) {
    <p class="text-red-600 text-xs mt-1">⚠️ {{ field.label }} é obrigatório</p>
    }
  </div>
  } }

  <!-- Botões -->
  <div class="col-span-2 flex justify-end gap-4 mt-6">
    <button type="reset" class="px-4 py-2 bg-gray-300 rounded-lg">
      Cancelar
    </button>
    <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-lg">
      Salvar
    </button>
  </div>
</form>

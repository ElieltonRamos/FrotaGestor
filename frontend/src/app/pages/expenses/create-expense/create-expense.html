<div class="p-6">
  <h2 class="text-2xl font-semibold mb-4">Registro de Despesa</h2>

  <!-- Seleção de veículo, motorista e viagem -->
  <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6">
    <!-- Veículo -->
    <div>
      <label class="block text-xs font-semibold text-gray-600 mb-1">
        Veículo
      </label>
      <div class="flex gap-2">
        <input
          type="text"
          class="border border-gray-300 rounded-lg px-3 py-1.5 w-full text-sm bg-gray-100"
          [value]="
            selectedVehicle
              ? selectedVehicle.model + ' (' + selectedVehicle.plate + ')'
              : ''
          "
          readonly
        />
        <button
          type="button"
          class="px-3 py-1.5 rounded bg-blue-600 text-white text-xs hover:bg-blue-700"
          (click)="showVehicleModal = true"
        >
          Selecionar
        </button>
      </div>
    </div>

    <!-- Motorista -->
    <div>
      <label class="block text-xs font-semibold text-gray-600 mb-1">
        Motorista
      </label>
      <div class="flex gap-2">
        <input
          type="text"
          class="border border-gray-300 rounded-lg px-3 py-1.5 w-full text-sm bg-gray-100"
          [value]="selectedDriver ? selectedDriver.name : ''"
          readonly
        />
        <button
          type="button"
          class="px-3 py-1.5 rounded bg-blue-600 text-white text-xs hover:bg-blue-700"
          (click)="showDriverModal = true"
        >
          Selecionar
        </button>
      </div>
    </div>

    <!-- Viagem -->
    <div>
      <label class="block text-xs font-semibold text-gray-600 mb-1">
        Viagem
      </label>
      <div class="flex gap-2">
        <input
          type="text"
          class="border border-gray-300 rounded-lg px-3 py-1.5 w-full text-sm bg-gray-100"
          [value]="
            selectedTrip
              ? selectedTrip.startLocation + ' → ' + selectedTrip.endLocation
              : ''
          "
          readonly
        />
        <button
          type="button"
          class="px-3 py-1.5 rounded bg-blue-600 text-white text-xs hover:bg-blue-700"
          (click)="showTripModal = true"
        >
          Selecionar
        </button>
      </div>
    </div>
  </div>

  <!-- Formulário principal -->
  <app-dynamic-form [fields]="expenseFields" (formSubmit)="saveExpense($event)">
  </app-dynamic-form>

  <!-- Modais -->
  <app-select-modal
    [show]="showVehicleModal"
    title="Selecionar Veículo"
    [columns]="vehicleColumns"
    [filtersConfig]="vehicleFilters"
    [dataFetcher]="vehicleFetcher"
    (select)="onVehicleSelect($event)"
    (close)="showVehicleModal = false"
  >
  </app-select-modal>

  <app-select-modal
    [show]="showDriverModal"
    title="Selecionar Motorista"
    [columns]="driverColumns"
    [filtersConfig]="driverFilters"
    [dataFetcher]="driverFetcher"
    (select)="onDriverSelect($event)"
    (close)="showDriverModal = false"
  >
  </app-select-modal>

  <app-select-modal
    [show]="showTripModal"
    title="Selecionar Viagem"
    [columns]="tripColumns"
    [filtersConfig]="tripFilters"
    [dataFetcher]="tripFetcher"
    (select)="onTripSelect($event)"
    (close)="showTripModal = false"
  >
  </app-select-modal>
</div>

<div
  class="max-w-6xl mx-auto mt-8 p-6 bg-white shadow-lg rounded-xl border border-gray-200"
>
  <!-- Section: Listagem de Dispositivos -->
  <div class="p-6 bg-gray-50 rounded-lg border border-gray-100">
    <h2 class="text-2xl font-semibold text-gray-900 mb-4">
      Dispositivos GPS Cadastrados
    </h2>
    <div class="flex flex-wrap justify-between mb-6 gap-4">
      <!-- Filtros dinâmicos -->
      <app-base-filter
        [filtersConfig]="gpsDeviceFilters"
        [(filter)]="filter"
        (apply)="applyFilters()"
        (clear)="clearFilters()"
        class="w-full lg:w-auto"
      ></app-base-filter>

      <!-- Paginador -->
      <div class="flex items-center w-full lg:w-auto">
        <app-paginator
          [totalItems]="total"
          [itemsPerPage]="limit"
          [totalPages]="totalPages"
          [page]="page"
          (pageChanged)="onPageChange($event)"
          class="w-full"
        ></app-paginator>
      </div>
    </div>

    <app-base-list
      [columns]="gpsDeviceColumns"
      [data]="gpsDevices"
      [page]="page"
      [limit]="limit"
      [total]="total"
      [totalPages]="totalPages"
      [sortKey]="sortKey"
      [sortAsc]="sortAsc"
      (sortChange)="sortBy($event)"
      (pageChange)="onPageChange($event)"
      (edit)="onEdit($event)"
      (details)="onNavDetails($event)"
      class="mb-6"
    ></app-base-list>

    <app-modal-edit-component
      [title]="'Gerenciar Dispositivo GPS'"
      [show]="showModal"
      [entity]="selectedDevice"
      [fields]="gpsDeviceFields"
      (close)="onCloseModal()"
      (save)="onSaveModal($event)"
    ></app-modal-edit-component>
  </div>

  <!-- Section: Criação de Dispositivo -->
  <div class="mt-8 p-6 bg-gray-50 rounded-lg border border-gray-100">
    <h2 class="text-2xl font-semibold text-gray-900 mb-4">
      Criar Novo Dispositivo GPS
    </h2>
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <div class="lg:col-span-2">
        <!-- Vehicle Selection -->
        <div class="mb-4">
          <label class="block text-xs font-semibold text-gray-600 mb-1"
            >Veículo</label
          >
          <div class="flex gap-2">
            <input
              type="text"
              class="border border-gray-300 rounded-lg px-3 py-1.5 w-full text-sm bg-gray-100"
              [value]="
                  selectedVehicle
                    ? `${selectedVehicle.plate} ${selectedVehicle.model}`
                    : ''
                "
              readonly
            />
            <button
              type="button"
              class="px-3 py-1.5 rounded bg-blue-600 text-white text-xs hover:bg-blue-700"
              (click)="showVehicleModal = true"
            >
              Selecionar
            </button>
          </div>
        </div>

        <!-- Dynamic Form for Device Fields -->
        <app-dynamic-form
          [fields]="gpsDeviceFields"
          (formSubmit)="saveDevice($event)"
          class="space-y-4"
        ></app-dynamic-form>
      </div>
      <div class="lg:col-span-1 flex items-center justify-center">
        <img
          src="device-gps.png"
          alt="Ilustração de dispositivo GPS"
          class="max-h-56 opacity-90 rounded-lg shadow-md"
        />
      </div>
    </div>

    <!-- Vehicle Selection Modal -->
    <app-select-modal
      [show]="showVehicleModal"
      title="Selecionar Veículo"
      [columns]="vehicleColumns"
      [filtersConfig]="vehicleFilters"
      [dataFetcher]="vehicleFetcher"
      (select)="onVehicleSelect($event)"
      (close)="showVehicleModal = false"
    ></app-select-modal>
  </div>
</div>

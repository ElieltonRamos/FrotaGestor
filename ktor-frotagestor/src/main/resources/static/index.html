<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FrotaGestor â€¢ Backend Online</title>
  <meta name="description" content="PÃ¡gina inicial do servidor do Gestor de Frota Online" />
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>ðŸšš</text></svg>">
  <style>
    :root{
      --bg: #0f172a;        /* slate-900 */
      --panel: #111827;     /* gray-900 */
      --panel-2: #0b1220;   /* deep */
      --text: #e5e7eb;      /* gray-200 */
      --muted: #9ca3af;     /* gray-400 */
      --brand: #38bdf8;     /* sky-400 */
      --ok: #22c55e;        /* green-500 */
      --warn: #f59e0b;      /* amber-500 */
      --err: #ef4444;       /* red-500 */
      --card: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
      --border: rgba(148,163,184,0.18);
      --shadow: 0 10px 30px rgba(0,0,0,0.35);
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg: #f8fafc;        /* slate-50 */
        --panel: #ffffff;
        --panel-2: #f1f5f9;   /* slate-100 */
        --text: #0f172a;      /* slate-900 */
        --muted: #475569;     /* slate-600 */
        --brand: #0ea5e9;     /* sky-500 */
        --border: rgba(15,23,42,0.12);
      }
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color: var(--text);
      background: radial-gradient(1200px 800px at 80% -10%, rgba(56,189,248,0.15), transparent),
                  radial-gradient(900px 600px at -10% 10%, rgba(34,197,94,0.12), transparent),
                  var(--bg);
      min-height: 100%;
    }
    header{
      display:flex; align-items:center; justify-content:space-between;
      padding: 22px 20px; gap: 16px; position: sticky; top:0; backdrop-filter: blur(6px);
      border-bottom: 1px solid var(--border); background: color-mix(in oklab, var(--bg), transparent 10%);
      z-index: 10;
    }
    .brand{ display:flex; align-items:center; gap:12px; }
    .logo{ width:36px; height:36px; display:grid; place-items:center; border-radius:12px; background:var(--panel-2); border:1px solid var(--border); box-shadow: var(--shadow); }
    .logo span{ font-size:20px; }
    .brand h1{ font-size: clamp(18px, 2vw, 22px); margin:0; letter-spacing:0.2px; }
    .muted{ color: var(--muted); font-size: 12.5px; }

    .actions{ display:flex; gap:10px; flex-wrap: wrap; }
    .btn{
      appearance:none; border:1px solid var(--border); background:var(--panel);
      color:var(--text); padding:10px 14px; border-radius:12px; font-weight:600; text-decoration:none;
      display:inline-flex; align-items:center; gap:10px; transition: transform .06s ease, border-color .2s ease, background .2s ease;
    }
    .btn:hover{ transform: translateY(-1px); border-color: color-mix(in oklab, var(--brand), #ffffff 70%); }
    .btn.primary{ background: linear-gradient(180deg, color-mix(in oklab, var(--brand), #ffffff 20%), var(--brand)); color:#082f49; border-color: transparent; }

    main{ max-width:1100px; margin: 28px auto; padding: 0 18px 40px; }

    .hero{
      display:grid; grid-template-columns: 1.1fr .9fr; gap:20px; align-items:stretch;
    }
    .card{
      background: var(--card); border:1px solid var(--border); border-radius:16px; padding: 18px; box-shadow: var(--shadow);
    }
    .panel{ background: var(--panel); }
    .title{ margin:0 0 8px; font-size: clamp(20px, 3vw, 28px); }
    .desc{ margin:0 0 14px; color:var(--muted); line-height:1.5; }

    .kpis{ display:grid; grid-template-columns: repeat(4, 1fr); gap:12px; margin-top: 12px; }
    .kpi{ padding:14px; border-radius:14px; border:1px solid var(--border); background: var(--panel); }
    .kpi .label{ font-size:12px; color:var(--muted); }
    .kpi .value{ font-size:20px; font-weight:700; margin-top:6px; }
    .dot{ width:10px; height:10px; border-radius:10px; display:inline-block; margin-right:6px; vertical-align:middle; }

    .grid{ display:grid; grid-template-columns: 1fr 1fr; gap:20px; margin-top:20px; }

    .list{ margin:0; padding:0; list-style:none; display:grid; gap:10px; }
    .list a{ text-decoration:none; color:inherit; }
    .item{
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      padding:12px 14px; border:1px solid var(--border); border-radius:12px; background: var(--panel);
    }
    .item .left{ display:flex; align-items:center; gap:10px; }
    .badge{ font-size:11px; padding:4px 8px; border-radius:999px; border:1px solid var(--border); background: var(--panel-2); color:var(--muted); }

    pre{ margin:0; background: var(--panel); border:1px solid var(--border); border-radius:12px; padding:14px; overflow:auto; }
    code{ font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; font-size: 12.5px; }

    footer{ max-width:1100px; margin: 24px auto 36px; padding:0 18px; color:var(--muted); font-size:12px; }

    @media (max-width: 920px){
      .hero{ grid-template-columns: 1fr; }
      .kpis{ grid-template-columns: repeat(2, 1fr); }
      .grid{ grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <div class="logo" aria-hidden="true"><span>ðŸšš</span></div>
      <div>
        <h1>FrotaGestor â€¢ API Backend</h1>
        <div class="muted">Servidor do Gestor de Frota Online</div>
      </div>
    </div>
    <nav class="actions">
      <a class="btn" href="/health" target="_blank" rel="noreferrer">/health</a>
      <a class="btn" href="/metrics" target="_blank" rel="noreferrer">/metrics</a>
      <a class="btn primary" href="/docs" target="_blank" rel="noreferrer">OpenAPI / Swagger</a>
    </nav>
  </header>

  <main>
    <section class="hero">
      <article class="card panel">
        <h2 class="title">Bem-vindo ðŸ‘‹</h2>
        <p class="desc">Este servidor fornece os serviÃ§os centrais do <strong>Gestor de Frota Online</strong>. Use os atalhos abaixo para checar saÃºde, mÃ©tricas e documentaÃ§Ã£o da API. InformaÃ§Ãµes de status atualizam em tempo real.</p>

        <div class="kpis" role="status">
          <div class="kpi" id="kpi-status">
            <div class="label">Status</div>
            <div class="value"><span class="dot" id="dot" style="background:var(--warn)"></span><span id="status-text">Verificando...</span></div>
          </div>
          <div class="kpi">
            <div class="label">Ambiente</div>
            <div class="value" id="env">-</div>
          </div>
          <div class="kpi">
            <div class="label">VersÃ£o</div>
            <div class="value" id="version">-</div>
          </div>
          <div class="kpi">
            <div class="label">Uptime</div>
            <div class="value" id="uptime">-</div>
          </div>
        </div>
      </article>

      <aside class="card panel">
        <h3 style="margin:0 0 10px">Como autenticar</h3>
        <p class="muted">Exemplo de login e uso de token <em>Bearer</em>:</p>
        <pre><code>curl -X POST http://localhost:3001/login \ 
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"admin123"}'

# resposta: {"type":"success","token":"&lt;jwt&gt;"}

# chamada autenticada
curl http://localhost:3001/vehicles \
  -H "Authorization: Bearer &lt;jwt&gt;"</code></pre>
      </aside>
    </section>

    <section class="grid">
      <article class="card panel">
        <h3 style="margin:0 0 8px">Endpoints Ãºteis</h3>
        <ul class="list">
          <li class="item">
            <div class="left"><span class="badge">POST</span><a href="/login" target="_blank" rel="noreferrer">/login</a></div>
            <span class="muted">AutenticaÃ§Ã£o</span>
          </li>
          <li class="item">
            <div class="left"><span class="badge">GET</span><a href="/health" target="_blank" rel="noreferrer">/health</a></div>
            <span class="muted">SaÃºde</span>
          </li>
          <li class="item">
            <div class="left"><span class="badge">GET</span><a href="/metrics" target="_blank" rel="noreferrer">/metrics</a></div>
            <span class="muted">MÃ©tricas</span>
          </li>
          <li class="item">
            <div class="left"><span class="badge">GET</span><a href="/docs" target="_blank" rel="noreferrer">/docs</a></div>
            <span class="muted">OpenAPI</span>
          </li>
          <li class="item">
            <div class="left"><span class="badge">GET</span><a href="/vehicles" target="_blank" rel="noreferrer">/vehicles</a></div>
            <span class="muted">VeÃ­culos</span>
          </li>
          <li class="item">
            <div class="left"><span class="badge">GET</span><a href="/drivers" target="_blank" rel="noreferrer">/drivers</a></div>
            <span class="muted">Motoristas</span>
          </li>
        </ul>
      </article>

      <article class="card panel">
        <h3 style="margin:0 0 8px">Notas rÃ¡pidas</h3>
        <ul class="list">
          <li class="item"><div class="left">CORS</div><span class="badge" id="cors">-</span></li>
          <li class="item"><div class="left">Rate Limit</div><span class="badge" id="rate">-</span></li>
          <li class="item"><div class="left">Banco de Dados</div><span class="badge" id="db">-</span></li>
          <li class="item"><div class="left">Auth Provider</div><span class="badge" id="auth">JWT</span></li>
        </ul>
      </article>
    </section>
  </main>

  <footer>
    <div>Â© <span id="year"></span> FrotaGestor â€¢ Backend</div>
  </footer>

  <script>
    // Ajuste os endpoints abaixo conforme a sua API expÃµe status/config
    const endpoints = {
      health: '/health',
      info: '/version',   // ex.: retorne { version, env, startedAt }
      config: '/config'   // ex.: retorne { cors: true, rateLimit: '100 r/m', db: 'MySQL' }
    };

    const el = (id) => document.getElementById(id);

    function fmtUptime(ms){
      if(!ms) return '-';
      const s = Math.floor(ms/1000);
      const d = Math.floor(s/86400);
      const h = Math.floor((s%86400)/3600);
      const m = Math.floor((s%3600)/60);
      const r = [];
      if(d) r.push(`${d}d`); if(h) r.push(`${h}h`); if(m) r.push(`${m}m`);
      return r.join(' ') || `${s}s`;
    }

    async function ping(){
      try{
        const r = await fetch(endpoints.health, { cache: 'no-store' });
        const ok = r.ok;
        el('dot').style.background = ok ? 'var(--ok)' : 'var(--err)';
        el('status-text').textContent = ok ? 'Online' : 'Offline';
      }catch{
        el('dot').style.background = 'var(--err)';
        el('status-text').textContent = 'Offline';
      }
    }

    async function loadInfo(){
      try{
        const r = await fetch(endpoints.info, { cache: 'no-store' });
        if(!r.ok) throw 0;
        const data = await r.json();
        el('version').textContent = data.version ?? '-';
        el('env').textContent = data.env ?? 'prod';
        // Se o backend retornar startedAt (timestamp), calcule uptime
        if(data.startedAt){
          const ms = Date.now() - new Date(data.startedAt).getTime();
          el('uptime').textContent = fmtUptime(ms);
        }
      }catch{
        el('version').textContent = '-';
        el('env').textContent = '-';
        el('uptime').textContent = '-';
      }
    }

    async function loadConfig(){
      try{
        const r = await fetch(endpoints.config, { cache: 'no-store' });
        if(!r.ok) throw 0;
        const data = await r.json();
        el('cors').textContent = data.cors ? 'ON' : 'OFF';
        el('rate').textContent = data.rateLimit ?? '-';
        el('db').textContent = data.db ?? '-';
      }catch{
        el('cors').textContent = '-';
        el('rate').textContent = '-';
        el('db').textContent = '-';
      }
    }

    function tick(){
      ping();
      // Atualiza uptime, se temos startedAt no /version
      // Em backend, expor /version com {version, env, startedAt}
    }

    // Init
    el('year').textContent = new Date().getFullYear();
    tick(); loadInfo(); loadConfig();
    setInterval(ping, 8000);
  </script>
</body>
</html>
